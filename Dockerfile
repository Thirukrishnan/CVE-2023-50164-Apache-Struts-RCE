FROM ubuntu:latest
RUN apt-get -y update && apt-get -y upgrade
RUN apt install openjdk-17-jdk -y
RUN apt install wget -y
RUN apt install curl -y

RUN mkdir /opt/tomcat/

WORKDIR /opt/tomcat
RUN wget https://dlcdn.apache.org/tomcat/tomcat-9/v9.0.83/bin/apache-tomcat-9.0.83.tar.gz
RUN gzip -d apache-tomcat-9.0.83.tar.gz
RUN tar -xvf apache-tomcat-9*tar -C /opt/tomcat --strip-components=1
RUN rm -f apache-tomcat-9*.tar.gz
RUN java -version

WORKDIR /opt/tomcat/webapps
RUN curl -O -L https://github.com/Thirukrishnan/CVE-2023-50164-Apache-Struts-RCE/raw/main/upload-1.0.0.war

EXPOSE 8080

CMD ["/opt/tomcat/bin/catalina.sh", "run"]